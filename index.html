<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trò Chơi Con Rắn Săn Mồi</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
            font-family: Arial, sans-serif;
        }
        #game-board {
            background-color: #fff;
            border: 2px solid #000;
            position: relative;
            overflow: hidden;
        }
        .snake {
            background-color: #4CAF50;
            position: absolute;
        }
        .food {
            background-color: #F44336;
            position: absolute;
            border-radius: 50%;
        }
        #score {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 20px;
            color: #333;
        }
        #game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 30px;
            color: red;
            display: none;
        }
    </style>
</head>
<body>
    <div id="game-board"></div>
    <script>
        const boardSize = 400; // Kích thước bảng chơi (pixel)
        const blockSize = 20; // Kích thước mỗi ô (pixel)
        const rows = boardSize / blockSize;
        const cols = boardSize / blockSize;

        const board = document.getElementById('game-board');
        board.style.width = `${boardSize}px`;
        board.style.height = `${boardSize}px`;

        // Tạo phần tử điểm số và game over
        const scoreElement = document.createElement('div');
        scoreElement.id = 'score';
        scoreElement.innerText = 'Điểm: 0';
        board.appendChild(scoreElement);

        const gameOverElement = document.createElement('div');
        gameOverElement.id = 'game-over';
        gameOverElement.innerText = 'Game Over! Nhấn phím cách để chơi lại.';
        board.appendChild(gameOverElement);

        let snake = [{ x: 10, y: 10 }]; // Vị trí ban đầu của rắn
        let food = { x: Math.floor(Math.random() * cols), y: Math.floor(Math.random() * rows) };
        let direction = { x: 1, y: 0 }; // Hướng di chuyển ban đầu (phải)
        let score = 0;
        let gameInterval;
        let isGameOver = false;

        // Vẽ rắn và mồi
        function draw() {
            // Xóa bảng
            while (board.firstChild && board.firstChild !== scoreElement && board.firstChild !== gameOverElement) {
                board.removeChild(board.firstChild);
            }

            // Vẽ rắn
            snake.forEach(part => {
                const snakePart = document.createElement('div');
                snakePart.classList.add('snake');
                snakePart.style.width = `${blockSize}px`;
                snakePart.style.height = `${blockSize}px`;
                snakePart.style.left = `${part.x * blockSize}px`;
                snakePart.style.top = `${part.y * blockSize}px`;
                board.appendChild(snakePart);
            });

            // Vẽ mồi
            const foodElement = document.createElement('div');
            foodElement.classList.add('food');
            foodElement.style.width = `${blockSize}px`;
            foodElement.style.height = `${blockSize}px`;
            foodElement.style.left = `${food.x * blockSize}px`;
            foodElement.style.top = `${food.y * blockSize}px`;
            board.appendChild(foodElement);

            // Cập nhật điểm
            scoreElement.innerText = `Điểm: ${score}`;
        }

        // Cập nhật vị trí rắn
        function update() {
            if (isGameOver) return;

            const head = { x: snake[0].x + direction.x, y: snake[0].y + direction.y };

            // Kiểm tra va chạm tường
            if (head.x < 0 || head.x >= cols || head.y < 0 || head.y >= rows) {
                gameOver();
                return;
            }

            // Kiểm tra va chạm chính mình
            if (snake.some(part => part.x === head.x && part.y === head.y)) {
                gameOver();
                return;
            }

            snake.unshift(head); // Thêm đầu mới

            // Ăn mồi
            if (head.x === food.x && head.y === food.y) {
                score += 10;
                food = { x: Math.floor(Math.random() * cols), y: Math.floor(Math.random() * rows) };
            } else {
                snake.pop(); // Xóa đuôi nếu không ăn
            }

            draw();
        }

        // Xử lý game over
        function gameOver() {
            isGameOver = true;
            clearInterval(gameInterval);
            gameOverElement.style.display = 'block';
        }

        // Xử lý phím bấm
        document.addEventListener('keydown', e => {
            if (isGameOver && e.key === ' ') {
                // Chơi lại
                snake = [{ x: 10, y: 10 }];
                food = { x: Math.floor(Math.random() * cols), y: Math.floor(Math.random() * rows) };
                direction = { x: 1, y: 0 };
                score = 0;
                isGameOver = false;
                gameOverElement.style.display = 'none';
                gameInterval = setInterval(update, 100);
                draw();
                return;
            }

            switch (e.key) {
                case 'ArrowUp': if (direction.y !== 1) direction = { x: 0, y: -1 }; break;
                case 'ArrowDown': if (direction.y !== -1) direction = { x: 0, y: 1 }; break;
                case 'ArrowLeft': if (direction.x !== 1) direction = { x: -1, y: 0 }; break;
                case 'ArrowRight': if (direction.x !== -1) direction = { x: 1, y: 0 }; break;
            }
        });

        // Bắt đầu game
        draw();
        gameInterval = setInterval(update, 100); // Tốc độ: 100ms mỗi bước
    </script>
</body>
</html>
